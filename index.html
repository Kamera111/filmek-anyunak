<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filmek Anyunak</title>
    <style>
        body { background: #16242e; color: #2de0ee; font-family: 'Roboto', Arial, sans-serif; margin: 0; }
        h1 { text-align: center; margin-top: 30px; font-size: 3rem; }
        .gomb-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; max-width: 650px; margin: 0 auto; margin-top: 38px; }
        .gomb { background: #17313e; border: none; border-radius: 26px; font-size: 2.2rem; font-weight: bold; color: #2de0ee; padding: 38px 0; margin: 0; cursor: pointer; transition: 0.12s; box-shadow: 0 3px 15px #0008; position: relative; }
        .gomb[disabled] { opacity: 0.55; cursor: not-allowed; }
        .gomb.uj:after { content: attr(data-uj); position: absolute; top: 14px; right: 20px; background: #e03647; color: #fff; font-size: 1.1rem; border-radius: 12px; padding: 2px 12px; }
        .footer { text-align: center; margin-top: 42px; margin-bottom: 18px; color: #aaa; font-size: 1rem; }
        #pinOverlay, #adminOverlay, #feltoltOverlay { position: fixed; left: 0; top: 0; width: 100vw; height: 100vh; background: #fff9; display: flex; align-items: center; justify-content: center; z-index: 100; }
        .pin-box, .admin-box, .feltolt-box { background: #fff; border-radius: 48px; padding: 44px 50px 38px 50px; box-shadow: 0 6px 44px #0007; text-align: center; min-width: 380px; }
        .pin-title, .admin-title, .feltolt-title { font-size: 2.5rem; font-weight: bold; color: #222; margin-bottom: 28px; }
        .pin-input, .admin-input, .feltolt-input, select { font-size: 2.5rem; width: 98%; padding: 15px; border: 3px solid #2de0ee; border-radius: 18px; margin: 16px 0 16px 0; box-sizing: border-box; text-align: center; background: #f9ffff; }
        .feltolt-label { display: block; color: #111; font-weight: bold; font-size: 1.18rem; margin: 13px 0 7px 2px; text-align: left;}
        .feltolt-btn { background: #2de0ee; color: #17313e; font-weight: bold; font-size: 1.4rem; border: none; border-radius: 14px; padding: 13px 40px; cursor: pointer; margin-top: 18px; }
        .feltolt-error { color: #e03647; font-size: 1.15rem; min-height: 2em; }
        .kilepes { width: 96%; max-width: 750px; background: #e03647; color: #fff; font-weight: bold; font-size: 2rem; border: none; border-radius: 24px; padding: 22px 0; display: block; margin: 30px auto 0 auto; cursor: pointer; }
        @media (max-width: 700px) {
          .gomb-grid { grid-template-columns: 1fr; gap: 16px; }
          .pin-box, .admin-box, .feltolt-box { min-width: 95vw; padding: 26px 5vw 24px 5vw; }
        }
    </style>
</head>
<body>
    <h1>Filmek Anyunak</h1>
    <div id="gombok" class="gomb-grid"></div>
    <button class="kilepes" onclick="kilepes()">Kilépés mindenből</button>
    <div class="footer">© 2024 Kamera111 & ChatGPT</div>

    <!-- PIN beírás overlay -->
    <div id="pinOverlay">
      <div class="pin-box">
        <div class="pin-title">Írd be a PIN-kódot a belépéshez</div>
        <input id="pinInput" class="pin-input" type="password" maxlength="8" autocomplete="off" autofocus>
        <div id="pinError" style="height:1.7em; color:#e03647"></div>
      </div>
    </div>

    <!-- Admin PIN overlay -->
    <div id="adminOverlay" style="display:none;">
      <div class="admin-box">
        <div class="admin-title">Admin PIN a feltöltéshez</div>
        <input id="adminInput" class="admin-input" type="password" maxlength="8" autocomplete="off" autofocus>
        <button class="feltolt-btn" onclick="adminPINellenorzes()">Belépés adminként</button>
        <div id="adminError" style="height:1.7em; color:#e03647"></div>
      </div>
    </div>

    <!-- Feltöltő overlay -->
    <div id="feltoltOverlay" style="display:none;">
      <form class="feltolt-box" onsubmit="return mentesFeltoltes()">
        <div class="feltolt-title">Film feltöltése</div>
        <label class="feltolt-label" for="feltoltKategoriak">Kategória:</label>
        <select id="feltoltKategoriak" class="feltolt-input"></select>
        <label class="feltolt-label" for="feltoltCim">Film címe:</label>
        <input id="feltoltCim" class="feltolt-input" type="text" maxlength="64" required>
        <label class="feltolt-label" for="feltoltLink">Film linkje:</label>
        <input id="feltoltLink" class="feltolt-input" type="url" maxlength="256" required>
        <button type="submit" class="feltolt-btn">Mentés</button>
        <button type="button" class="feltolt-btn" style="background:#e03647;color:#fff;margin-left:12px;" onclick="feltoltoBezar()">Mégse</button>
        <div class="feltolt-error" id="feltoltError"></div>
      </form>
    </div>

    <script>
        // ----- Gombok adatai -----
        const GOMBS = [
            { nev: "Krimi" },         { nev: "Akció" },
            { nev: "Thriller" },      { nev: "Kaland" },
            { nev: "Vígjáték" },      { nev: "Sorozatok" },
            { nev: "F" },             { nev: "Új filmek" },
            { nev: "Thriller TV" },   { nev: "Top Filmek" },
            { nev: "Akció TV" },      { nev: "Vígjáték TV" },
            { nev: "Beszélgetés" },   { nev: "(Üres hely)" },
        ];

        // ----- PIN kódok -----
        const USER_PIN = "1954";
        const ADMIN_PIN = "2014";

        // ----- Adatok -----
        let kategoriak = GOMBS.map(g => g.nev).filter(n => !["F","(Üres hely)","Beszélgetés"].includes(n));
        let ujak = JSON.parse(localStorage.getItem("ujak") || "{}"); // { kategória: db }
        let filmek = JSON.parse(localStorage.getItem("filmek") || "{}"); // { kategória: [ {cim, link} ] }

        // ----- Gombok kirajzolása -----
        function frissitGombok() {
            const grid = document.getElementById("gombok");
            grid.innerHTML = "";
            GOMBS.forEach((g, i) => {
                let btn = document.createElement("button");
                btn.className = "gomb";
                btn.textContent = g.nev;
                if (ujak[g.nev] && ujak[g.nev] > 0) {
                    btn.classList.add("uj");
                    btn.setAttribute("data-uj", `${ujak[g.nev]} új`);
                }
                btn.onclick = () => gombKatt(g.nev);
                if (g.nev == "(Üres hely)") btn.disabled = true;
                grid.appendChild(btn);
            });
        }

        // ----- Gomb események -----
        function gombKatt(nev) {
            if (nev == "F") return adminFeltolto();
            if (nev == "Beszélgetés") return alert("Ez a funkció hamarosan ChatGPT-t integrálja!");
            if (nev == "(Üres hely)") return;
            if (kategoriak.includes(nev)) {
                // Film lista (egyszerű példa)
                let lista = filmek[nev] || [];
                let msg = lista.length ? 
                  lista.map(f => f.cim + ": " + f.link).join('\n\n') : "Még nincs feltöltött film.";
                alert(msg);
                ujak[nev] = 0;
                localStorage.setItem("ujak", JSON.stringify(ujak));
                frissitGombok();
                return;
            }
            alert(`Ez a funkció később lesz kész: ${nev.toLowerCase()}`);
        }

        // ----- Kilépés -----
        function kilepes() {
            localStorage.removeItem("pin_ok");
            localStorage.removeItem("admin_ok");
            location.reload();
        }

        // ----- PIN belépés -----
        window.onload = () => {
            if (localStorage.getItem("pin_ok") == "1") {
                document.getElementById("pinOverlay").style.display = "none";
            }
            frissitGombok();
        };
        document.getElementById("pinInput").onkeydown = function(e) {
            if (e.key === "Enter") ellenorizPIN();
        };
        function ellenorizPIN() {
            let be = document.getElementById("pinInput").value;
            if (be == USER_PIN) {
                localStorage.setItem("pin_ok", "1");
                document.getElementById("pinOverlay").style.display = "none";
                frissitGombok();
            } else {
                document.getElementById("pinError").textContent = "Helytelen PIN!";
            }
        }

        // ----- Admin feltöltő -----
        function adminFeltolto() {
            if (localStorage.getItem("admin_ok") == "1") {
                return nyitFeltolto();
            }
            document.getElementById("adminOverlay").style.display = "";
            document.getElementById("adminInput").focus();
        }
        document.getElementById("adminInput").onkeydown = function(e) {
            if (e.key === "Enter") adminPINellenorzes();
        };
        function adminPINellenorzes() {
            let be = document.getElementById("adminInput").value;
            if (be == ADMIN_PIN) {
                localStorage.setItem("admin_ok", "1");
                document.getElementById("adminOverlay").style.display = "none";
                nyitFeltolto();
            } else {
                document.getElementById("adminError").textContent = "Helytelen PIN!";
            }
        }
        function nyitFeltolto() {
            // Frissítse a legördülő kategória listát
            let sel = document.getElementById("feltoltKategoriak");
            sel.innerHTML = "";
            kategoriak.forEach(k => {
                let o = document.createElement("option");
                o.value = k; o.textContent = k;
                sel.appendChild(o);
            });
            document.getElementById("feltoltOverlay").style.display = "";
            document.getElementById("feltoltCim").value = "";
            document.getElementById("feltoltLink").value = "";
            document.getElementById("feltoltError").textContent = "";
            document.getElementById("feltoltCim").focus();
        }
        function feltoltoBezar() {
            document.getElementById("feltoltOverlay").style.display = "none";
        }

        // ----- Feltöltés mentése -----
        function mentesFeltoltes() {
            let kat = document.getElementById("feltoltKategoriak").value;
            let cim = document.getElementById("feltoltCim").value.trim();
            let link = document.getElementById("feltoltLink").value.trim();
            let hiba = "";
            if (!kat) hiba = "Kategória kiválasztása kötelező!";
            else if (!cim) hiba = "Cím megadása kötelező!";
            else if (!link.match(/^https?:\/\/\S+/)) hiba = "Érvényes link szükséges!";
            if (hiba) {
                document.getElementById("feltoltError").textContent = hiba;
                return false;
            }
            // Mentés
            if (!filmek[kat]) filmek[kat] = [];
            filmek[kat].push({ cim, link });
            ujak[kat] = (ujak[kat] || 0) + 1;
            localStorage.setItem("filmek", JSON.stringify(filmek));
            localStorage.setItem("ujak", JSON.stringify(ujak));
            feltoltoBezar();
            frissitGombok();
            alert("Sikeres feltöltés!");
            return false;
        }
    </script>
</body>
</html>
